// ============================================================================
// THE STARTER (dse_onenter)
// ============================================================================
// This script belongs in: Area Properties -> Events -> OnEnter
// ============================================================================
#include "dse_inc"

void main() {
    object oEntering = GetEnteringObject();
    string sName = GetName(oEntering);
    object oArea = OBJECT_SELF;

    // RULE: Only add real Players, or our test NPCs Bob and Bill.
    if (GetIsPC(oEntering) || sName == "Bob" || sName == "Bill") {

        // Find out how many people are already in the list and add 1.
        int nCount = GetLocalInt(oArea, "AREA_PC_COUNT") + 1;

        // Store the person in a "Slot" (like a parking space).
        SetLocalInt(oArea, "AREA_PC_COUNT", nCount);
        SetLocalObject(oArea, "PLAYER_SLOT_" + IntToString(nCount), oEntering);

        // Turn the system "ON" for this person.
        SetLocalInt(oEntering, VAR_SYSTEM_RUNNING, 1);

        DSE_Debug(oEntering, sName + " added to VIP Slot " + IntToString(nCount));

        // If the "Brain" loop isn't running yet, start it!
        if (!GetLocalInt(oArea, "DSE_LOOP_RUNNING")) {
            SetLocalInt(oArea, "DSE_LOOP_RUNNING", 1);
            ExecuteScript("dse_area_loop", oArea);
        }
    }
}
